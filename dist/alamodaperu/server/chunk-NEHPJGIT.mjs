import './polyfills.server.mjs';
import{a as h}from"./chunk-Q2MVUTIL.mjs";import{a as ee}from"./chunk-MY4FQTNP.mjs";import{a as te}from"./chunk-PRSPCPCG.mjs";import"./chunk-YCM6RVGE.mjs";import"./chunk-B22Y7IUL.mjs";import{a as Z}from"./chunk-SMWEGEUO.mjs";import{a as X}from"./chunk-OUZKNZ4Z.mjs";import{a as Y}from"./chunk-IDSKALUM.mjs";import{a as K}from"./chunk-WSQWBVCP.mjs";import"./chunk-UIV4R5VV.mjs";import"./chunk-UFXCTN3F.mjs";import{a as m}from"./chunk-GLNDTVHY.mjs";import"./chunk-4HU5A5SJ.mjs";import{Ea as n,Ec as B,Fa as a,Gc as k,Hc as R,Jb as D,Jd as j,La as s,Od as z,Pd as O,Qd as w,Ua as c,Wd as G,Xe as J,f as _,fa as u,gc as S,ge as H,he as V,i as v,ja as d,je as x,kc as N,ke as W,lc as I,le as L,ma as C,mc as M,me as U,nc as F,ne as $,o as P,pa as y,pe as q,qe as Q,rc as T,uc as E,xa as l,xc as A}from"./chunk-QOSB5ZEG.mjs";import{a as g,b}from"./chunk-S6KH3LOX.mjs";var oe=class f extends Z{constructor(t,i,e,o,r,p){super(i,e,r);this.fb=t;this.productService=o;this.router=p}productForm;datas=[];isLoading=!1;searchButtonDisabled=!0;listError;isdelelete;ngOnInit(){this.buildForm(),this.loadProducts(),this.findProductProcess()}buildForm(){this.productForm=this.fb.group({id:[""],name:["",I.required],category:[""],barcode:[""],price:[""],stock:[""]})}columnMapping(){return{id:"ID",name:"Name",description:"Description",barcode:"Barcode",supplierName:"Supplier",sizes:"Sizes",expirationDate:"Expiration Date",manufacturingDate:"Manufacturing Date",pricing:"Pricing",inventory:"Inventory",category:"Category"}}loadProducts(){this.productService.product$.subscribe(t=>{this.processProductData(t),this.spinnerService.hide()})}processProductData(t){this.datas=this.customizePropertyNames(t,this.columnMapping()),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1)}checkInputs(){let t=this.productForm.get("id")?.value||"",i=this.productForm.get("name")?.value||"",e=this.productForm.get("category")?.value||"",o=this.productForm.get("barcode")?.value||"";this.searchButtonDisabled=!(t||i||e||o),this.searchButtonDisabled&&this.findProductProcess()}findProductProcess(){this.spinnerService.show();let t=this.productForm.value.id||"",i=this.productForm.value.name||"",e=this.productForm.value.category||"",o=this.productForm.value.barcode||"";this.productService.findProducts(this.page,this.pageSize,t,i,e,o).pipe(v(r=>{let p=r?.payload||[];return this.customizePropertyNames(p,this.columnMapping())}),P(r=>(console.error("Error fetching employees:",r),_([])))).subscribe(r=>{this.datas=r,console.log("Data source page",this.datas),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1),this.spinnerService.hide()})}findByparameter(){this.listError=this.validateObjectID(),this.listError.length===0&&(this.productForm.get("id")?.markAsTouched(),this.page=m.page,this.pageSize=m.perPage,this.findProductProcess())}validateObjectID(){let t=this.productForm.get("id")?.value||"",i=[],e=h.isValidObjectId(t);return h.empty(t)||e||i.push("ID is not valid."),i}onNewClick(){this.router.navigate(["/support/product/detail","new"])}handleEditAction(t){if(!t?.data?.ID){console.warn("Invalid product data.");return}let i=t.data.ID;this.router.navigate(["support/product/detail",i])}handleDeleteAction(t){debugger;if(console.log("Deleting:",t),t.data.ID!==void 0){let i=t.data.ID;this.productService.deleteProduct(i).subscribe(e=>{this.showSuccessMessage("Delete Success","Success"),this.isdelelete=t},e=>{(e.status===422||e.status===500)&&e.error&&e.error.data&&e.error.data.payload&&e.error.data.payload.forEach(o=>{let r=o.propertyPath,p=o.valExceptionDescription;this.productForm.get(r)?.setErrors({invalid:!0,customError:p})}),this.spinnerService.hide()})}}deleting(t){this.dialogService.open(X,{context:{rowData:b(g({},t.data),{typeDescription:"QUESTION",description:`"${t.data.Name}"?`})}}).onClose.subscribe(e=>{e==="deleteConfirmed"&&(this.handleDeleteAction(t),this.findProductProcess())})}static \u0275fac=function(i){return new(i||f)(d(B),d(K),d(Y),d(te),d(q),d(S))};static \u0275cmp=C({type:f,selectors:[["app-product"]],features:[y],decls:23,vars:6,consts:[[1,"form-container"],[3,"formGroup"],["multi","true"],["expanded","true"],[1,"form-grid"],["nbInput","","fullWidth","","type","text","placeholder","ID","formControlName","id",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Name","formControlName","name",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Category","formControlName","category",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Barcode","formControlName","barcode",3,"input"],[1,"button-container"],["nbButton","","status","primary",3,"click","disabled"],["nbButton","","status","success",3,"click"],[3,"pageChange","pageSizeChange","deleteAction","editAction","loadMoreData","noData","datas","defaultColumns","isdelelete","hasMorePages"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"form",1)(2,"nb-accordion",2)(3,"nb-accordion-item",3)(4,"nb-accordion-item-header"),c(5," Product "),a(),n(6,"nb-accordion-item-body")(7,"div",4)(8,"input",5),s("input",function(){return e.checkInputs()}),a(),n(9,"input",6),s("input",function(){return e.checkInputs()}),a(),n(10,"input",7),s("input",function(){return e.checkInputs()}),a(),n(11,"input",8),s("input",function(){return e.checkInputs()}),a()(),n(12,"div",9)(13,"button",10),s("click",function(){return e.findByparameter()}),c(14," Search "),a(),n(15,"button",11),s("click",function(){return e.onNewClick()}),c(16," New "),a()()()()(),n(17,"nb-accordion",2)(18,"nb-accordion-item",3)(19,"nb-accordion-item-header"),c(20," Data Information "),a(),n(21,"nb-accordion-item-body")(22,"app-table-datasource",12),s("pageChange",function(r){return e.onPageChange(r)})("pageSizeChange",function(r){return e.onPageSizeChange(r)})("deleteAction",function(r){return e.deleting(r)})("editAction",function(r){return e.handleEditAction(r)})("loadMoreData",function(){return e.findProductProcess()})("noData",function(){return e.showNoDataMessage()}),a()()()()()()),i&2&&(u(),l("formGroup",e.productForm),u(12),l("disabled",e.searchButtonDisabled),u(9),l("datas",e.datas)("defaultColumns",e.defaultColumnsInput)("isdelelete",e.isdelelete)("hasMorePages",e.hasMorePagesT))},dependencies:[D,R,T,N,M,F,E,A,k,w,O,z,V,H,j,Q,G,$,x,W,U,L,J,ee],styles:[".form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}"]})};export{oe as ProductComponent};
