import './polyfills.server.mjs';
import{a as ve,b as Z}from"./chunk-YQLU63JA.mjs";import{a as be,b as ge,c as z}from"./chunk-NQB6LHGR.mjs";import"./chunk-P35HLMGX.mjs";import{a as L}from"./chunk-C2CAX4T5.mjs";import{a as U}from"./chunk-WSQWBVCP.mjs";import{a as he}from"./chunk-3RHJLDCC.mjs";import{a as d}from"./chunk-2LDEZLBL.mjs";import{a as X}from"./chunk-2CRQO2D4.mjs";import"./chunk-3JMC3KGE.mjs";import{$ as S,Cd as le,Dd as me,Ea as p,Fd as q,Gb as ne,Ld as x,Md as j,Na as f,Od as ue,Pd as de,Qd as ce,Rd as fe,Sd as w,Td as Se,Ud as V,Vd as $,ac as N,bc as i,c as oe,cc as D,d as v,da as l,dc as I,fa as y,g as Y,hc as M,ia as C,jc as R,l as K,lc as P,pc as ae,q as re,qa as h,rc as F,s as ie,sd as E,tc as T,uc as A,ud as se,v as J,wd as pe,xa as n,xd as B,ya as s,yd as O,ye as G,za as Q,zb as _,zd as k}from"./chunk-DSI7I6RW.mjs";import{a as te}from"./chunk-S6KH3LOX.mjs";var H=class{};var b=class m extends H{constructor(t,o){super();this.http=t;this.apiService=o}storeSubject=new oe([]);store$=this.storeSubject.asObservable();findStores(t,o,e,r,a,c){let u={page:t,pagesize:o,id:e,name:r,country:a,status:c},W=`${d.API_SUPPORT}/${d.URL_TYPE_ACCES_PRIVATE}/v1/support/store`;return this.apiService.get(W,u)}getStoreById(t){let o=`${d.API_SUPPORT}/${d.URL_TYPE_ACCES_PRIVATE}/v1/support/store/${t}`;return this.apiService.get(o)}saveStore(t){let o={data:t,trace:{traceId:"01"}},e=`${d.API_SUPPORT}/${d.URL_TYPE_ACCES_PRIVATE}/v1/support/store`;return this.apiService.post(e,o)}deleteStore(t){let o=`${d.API_SUPPORT}/${d.URL_TYPE_ACCES_PRIVATE}/v1/support/store/${t}`;return this.apiService.delete(o)}fetchStores(t,o,e,r,a,c){this.findStores(t,o,e,r,a,c).subscribe(u=>{this.storeSubject.next(u.payload)})}reloadStores(){this.storeSubject.next(this.storeSubject.value)}static \u0275fac=function(o){return new(o||m)(J(ne),J(he))};static \u0275prov=ie({token:m,factory:m.\u0275fac,providedIn:"root"})};var g=class m extends z{constructor(t,o,e,r,a,c){super(c,r,o);this.fb=t;this.storeService=e;this.dialogRef=a}ngOnInit(){this.buildForm(),this.entityData&&this.patchFormValues(),window.addEventListener("keydown",this.handleEscKey.bind(this))}patchFormValues(){this.entityData&&this.formData.patchValue({id:this.entityData.id||"",name:this.entityData.name||"",address:this.entityData.address||"",country:this.entityData.country||"",email:this.entityData.email||"",phone:this.entityData.phone||"",status:this.entityData.status||"",ownerName:this.entityData.ownerName||""})}buildForm(){this.formData=this.fb.group({id:[],name:["Default Name",i.required],address:["Default Address",i.required],country:["Default Country",i.required],email:["default@email.com",[i.required,i.email]],phone:["000-000-0000",i.required],status:["Active",i.required],ownerName:["Default Owner",i.required]})}onSubmit(){debugger;let t=te({},this.formData.value);this.spinnerService.show(),this.storeService.saveStore(t).subscribe({next:()=>this.handleSuccessResponseSaveOrUpdate(t),error:o=>this.handleErrorResponseSaveOrUpdate(o)})}onBarcodeScanned(t){this.formData.patchValue({barcode:t})}static \u0275fac=function(o){return new(o||m)(l(F),l(L),l(b),l(U),l(Se),l(V))};static \u0275cmp=y({type:m,selectors:[["app-store-detail"]],features:[C],decls:17,vars:2,consts:[[1,"form-container"],[3,"title"],[1,"form-container",3,"ngSubmit","formGroup"],["nbInput","","type","text","placeholder","ID","formControlName","id","readonly","",1,"form-group"],["nbInput","","type","text","placeholder","Name","formControlName","name","required","",1,"form-group"],["nbInput","","type","text","placeholder","Address","formControlName","address","required","",1,"form-group"],["nbInput","","type","text","placeholder","Country","formControlName","country","required","",1,"form-group"],["nbInput","","type","email","placeholder","Email","formControlName","email","required","",1,"form-group"],["nbInput","","type","text","placeholder","Phone","formControlName","phone","required","",1,"form-group"],["nbInput","","type","text","placeholder","Owner Name","formControlName","ownerName","required","",1,"form-group"],["nbInput","","type","text","placeholder","Status","formControlName","status","required","",1,"form-group"],[1,"button-container"],["nbButton","","hero","","status","success","type","submit"],["nbButton","","hero","","status","danger","type","button",3,"click"]],template:function(o,e){o&1&&(n(0,"nb-card",0)(1,"nb-card-body"),Q(2,"app-modal-header",1),n(3,"form",2),p("ngSubmit",function(){return e.onSubmit()}),Q(4,"input",3)(5,"input",4)(6,"input",5)(7,"input",6)(8,"input",7)(9,"input",8)(10,"input",9)(11,"input",10),n(12,"app-modal-footer",11)(13,"button",12),f(14,"Save"),s(),n(15,"button",13),p("click",function(){return e.closeDialog()}),f(16,"Cancel"),s()()()()()),o&2&&(S(2),h("title","Store Detail"),S(),h("formGroup",e.formData))},dependencies:[_,A,M,N,D,I,ae,R,P,T,k,O,B,pe,se,j,x,E,$,q,w,G,ge,be],styles:[".form-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;padding:16px;max-width:600px;margin:auto}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}"]})};var _e=class m extends z{constructor(t,o,e,r,a){super(a,o,e);this.fb=t;this.storeService=r}StoreForm;datas=[];isLoading=!1;searchButtonDisabled=!0;listError;isdelelete;ngOnInit(){this.buildForm(),this.loadStores(),this.finStoreProcess()}buildForm(){this.StoreForm=this.fb.group({id:["",i.required],name:["",i.required],address:["",i.required],country:["",i.required],email:["",[i.required,i.email]],phone:["",i.required],status:["",i.required],ownerName:["",i.required]})}columnMapping(){return{id:"ID",name:"Store Name",address:"Address",country:"Country",email:"Email",phone:"Phone",status:"Status",ownerName:"Owner Name"}}loadStores(){this.storeService.store$.subscribe(t=>{this.processStoreData(t),this.spinnerService.hide()})}processStoreData(t){this.datas=this.customizePropertyNames(t,this.columnMapping()),this.setDefaultColumns(this.datas),this.updateHasMorePagesT(this.datas&&this.datas.length>0)}checkInputs(){let t=this.StoreForm.get("id")?.value||"",o=this.StoreForm.get("name")?.value||"",e=this.StoreForm.get("country")?.value||"",r=this.StoreForm.get("email")?.value||"",a=this.StoreForm.get("phone")?.value||"",c=this.StoreForm.get("status")?.value||"";this.searchButtonDisabled=!(t||o||e||r||a||c),this.searchButtonDisabled&&this.finStoreProcess()}finStoreProcess(){this.spinnerService.show();let{id:t,name:o,country:e,email:r,phone:a,status:c}=this.StoreForm.value;this.storeService.findStores(this.page,this.pageSize,t,o,e,r).pipe(Y(u=>{let W=u?.payload||[];return this.customizePropertyNames(W,this.columnMapping())}),K(u=>(console.error("Error fetching stores:",u),v([])))).subscribe(u=>{this.datas=u,this.setDefaultColumns(this.datas),this.updateHasMorePagesT(this.datas&&this.datas.length>0),this.spinnerService.hide()})}findByparameter(){this.listError=this.validateObjectID(),this.listError.length===0&&(this.StoreForm.get("id")?.markAsTouched(),this.page=X.page,this.pageSize=X.perPage,this.finStoreProcess())}validateObjectID(){let t=this.StoreForm.get("id")?.value||"",o=[],e=Z.isValidObjectId(t);return!Z.empty(t)&&!e&&o.push("ID is not valid."),o}onNewClick(){this.dialogService.open(g,{context:{},closeOnBackdropClick:!1,hasBackdrop:!0,backdropClass:"custom-backdrop",dialogClass:"custom-dialog"}).onClose.subscribe(t=>{t&&this.finStoreProcess()})}handleEditAction(t){debugger;if(!t?.data?.ID){console.warn("Invalid Store data.");return}let o=t.data.ID;this.storeService.findStores(1,1,o,"","","").pipe(Y(e=>e.payload?.[0]||null),K(e=>(console.error("Error fetching Store:",e),v(null))),re(e=>e?this.dialogService.open(g,{context:{entityData:e},closeOnBackdropClick:!1,hasBackdrop:!0}).onClose:(console.warn("Store not found."),v(null)))).subscribe(e=>{e&&this.finStoreProcess()})}handleDeleteAction(t){if(t.data.ID!==void 0){let o=t.data.ID;this.storeService.deleteStore(o).subscribe(()=>{this.showSuccessMessage("Delete Success","Success"),this.isdelelete=t},e=>{this.handleValidationErrors(e,this.formData)})}}deleting(t){this.openDeleteModal(t).componentRef.instance.deleteConfirmed.subscribe(()=>{this.handleDeleteAction(t)})}static \u0275fac=function(o){return new(o||m)(l(F),l(U),l(L),l(b),l(V))};static \u0275cmp=y({type:m,selectors:[["app-store"]],features:[C],decls:28,vars:6,consts:[[1,"form-container"],[3,"formGroup"],["multi","true"],["expanded","true"],[1,"form-grid"],["nbInput","","fullWidth","","type","text","placeholder","ID","formControlName","id",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Name","formControlName","name",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Address","formControlName","address",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Country","formControlName","country",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Email","formControlName","email",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Phone","formControlName","phone",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Owner Name","formControlName","ownerName",3,"input"],[1,"button-container"],["nbButton","","status","primary",3,"click","disabled"],["nbButton","","status","success",3,"click"],[3,"pageChange","pageSizeChange","deleteAction","editAction","loadMoreData","noData","datas","defaultColumns","isdelelete","hasMorePages"]],template:function(o,e){o&1&&(n(0,"nb-layout")(1,"nb-layout-column")(2,"div",0)(3,"form",1)(4,"nb-accordion",2)(5,"nb-accordion-item",3)(6,"nb-accordion-item-header"),f(7,"Store Information"),s(),n(8,"nb-accordion-item-body")(9,"div",4)(10,"input",5),p("input",function(){return e.checkInputs()}),s(),n(11,"input",6),p("input",function(){return e.checkInputs()}),s(),n(12,"input",7),p("input",function(){return e.checkInputs()}),s(),n(13,"input",8),p("input",function(){return e.checkInputs()}),s(),n(14,"input",9),p("input",function(){return e.checkInputs()}),s(),n(15,"input",10),p("input",function(){return e.checkInputs()}),s(),n(16,"input",11),p("input",function(){return e.checkInputs()}),s()(),n(17,"div",12)(18,"button",13),p("click",function(){return e.findByparameter()}),f(19,"Search"),s(),n(20,"button",14),p("click",function(){return e.onNewClick()}),f(21,"New"),s()()()()(),n(22,"nb-accordion",2)(23,"nb-accordion-item",3)(24,"nb-accordion-item-header"),f(25,"Data Information"),s(),n(26,"nb-accordion-item-body")(27,"app-table-datasource",15),p("pageChange",function(a){return e.onPageChange(a)})("pageSizeChange",function(a){return e.onPageSizeChange(a)})("deleteAction",function(a){return e.deleting(a)})("editAction",function(a){return e.handleEditAction(a)})("loadMoreData",function(){return e.finStoreProcess()})("noData",function(){return e.showNoDataMessage()}),s()()()()()()()()),o&2&&(S(3),h("formGroup",e.StoreForm),S(15),h("disabled",e.searchButtonDisabled),S(9),h("datas",e.datas)("defaultColumns",e.defaultColumnsInput)("isdelelete",e.isdelelete)("hasMorePages",e.hasMorePagesT))},dependencies:[_,A,M,N,D,I,R,P,T,k,O,B,j,x,E,$,q,le,me,w,ue,de,fe,ce,G,ve],styles:[".form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}"]})};export{_e as StoreComponent};
