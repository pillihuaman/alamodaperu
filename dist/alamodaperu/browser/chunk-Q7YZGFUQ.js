import{a as ie,b as I}from"./chunk-E5L23D6D.js";import"./chunk-GJEU6FZM.js";import{a as Z}from"./chunk-SQZJFXB2.js";import{a as ee}from"./chunk-K5HXVKPS.js";import{a as Y}from"./chunk-C4MTUD5M.js";import{a as te}from"./chunk-X3J7YRVF.js";import{a as h}from"./chunk-SGZVPLXZ.js";import{i as W,j as X}from"./chunk-ELOWQZB7.js";import{$a as x,Aa as f,Ab as E,Cb as O,Gb as V,Ia as c,Ib as B,Ja as P,Qb as j,Rc as k,Sb as w,Tb as A,Ua as q,Wc as G,Y as p,Yc as z,Zd as C,ab as y,ba as u,ea as b,fb as S,ha as N,ia as g,jd as K,la as l,ld as U,md as H,n as T,nd as L,od as Q,rd as $,sa as a,sd as J,ta as r,ua as v,va as _,wa as R,yb as M,za as D}from"./chunk-HKEP7HVR.js";function le(o,d){if(o&1&&(a(0,"div"),c(1),r()),o&2){let e=d.$implicit;p(),P(e)}}function de(o,d){if(o&1&&(_(0),g(1,le,2,1,"div",2),R()),o&2){let e=f(3);p(),l("ngForOf",e.errorMessages)}}function ce(o,d){if(o&1&&(a(0,"div"),c(1),r()),o&2){let e=f(3);p(),P(e.errorMessages)}}function me(o,d){if(o&1&&(_(0),g(1,de,2,1,"ng-container",1)(2,ce,2,1,"ng-template",null,0,q),R()),o&2){let e=f(2);p(),l("ngIf",e.errorMessages)}}function ue(o,d){if(o&1&&(a(0,"div"),g(1,me,4,1,"ng-container",1),r()),o&2){let e=f();p(),l("ngIf",e.errorMessages)}}var F=class o{control=null;errorMessages;isValidObjectId;isArray=!1;statusChangesSubscription=null;constructor(){console.log(this.control),console.log(this.errorMessages)}ngOnInit(){this.control&&(console.log("Control Status:",this.control.status),this.statusChangesSubscription=this.control.statusChanges.subscribe(()=>{this.isArray=Array.isArray(this.errorMessages),console.log(this.control)}))}ngOnDestroy(){this.statusChangesSubscription?.unsubscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-validation-message"]],inputs:{control:"control",errorMessages:"errorMessages",isValidObjectId:"isValidObjectId"},decls:1,vars:1,consts:[["singleMessage",""],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&g(0,ue,2,1,"div",1),e&2&&l("ngIf",t.control)},dependencies:[S,x,y,M,C],styles:["div[_ngcontent-%COMP%]{color:red}"]})};function ge(o,d){if(o&1&&v(0,"app-validation-message",10),o&2){let e=f();l("control",e.pageRequestForm.get("idToFind"))("errorMessages",e.listError)}}var oe=class o extends ie{constructor(e,t,i,n,s,m){super();this.fb=e;this.supportService=t;this.modalRepository=i;this.dialog=n;this.spinnerService=s;this.dialogService=m;this.pageRequest={}}pageRequestForm;pageRequest;datas=[];teestMod="tees";isLoading=!1;hasMorePagesT=!1;searchButtonDisabled=!0;typeOfSearch;listError;defaultColumnsInput=["id","title","content","isPublished","metaKeywords","metaDescription"];columnMappin(){return{id:"ID",title:"Page Title",content:"Page Content",isPublished:"Published",metaKeywords:"Keywords",metaDescription:"Description"}}processDataResult;ngOnInit(){this.buildForm(),this.findByDefualt()}handleActionClick(e){let t={data:e.data,description:e.data.any,typeDescription:"QUESTION".toString()};this.dialogService.open(Z,{context:{rowData:t}}).componentRef.instance.deleteConfirmed.subscribe(()=>{this.handleDeleteAction(e)})}isNewPage(){return!this.pageRequestForm.get("id")?.value}buildForm(){this.pageRequestForm=this.fb.group({id:[""],title:[this.pageRequest?.title,E.required],content:[this.pageRequest?.content],url:[this.pageRequest?.url],isPublished:[this.pageRequest?.isPublished],metaKeywords:[this.pageRequest?.metaKeywords],metaDescription:[this.pageRequest?.metaDescription],idToFind:"",titleToFind:"",contentToFind:"",urlToFind:""})}findPagesProcess(){this.spinnerService.show();let e=this.pageRequestForm.value.idToFind||"",t=this.pageRequestForm.value.titleToFind||"",i=this.pageRequestForm.value.contentToFind||"",n=this.pageRequestForm.value.urlToFind||"";this.supportService.findPages(this.page,this.pageSize,e,t,i,n).pipe(T(s=>{let m=s.payload;return this.customizePropertyNames(m,this.columnMappin())})).subscribe(s=>{this.datas=s,console.log("Data source page",this.datas),this.datas&&this.datas.length>0?(console.log("Data"+Object.keys(this.datas[0].data)),this.defaultColumnsInput=Object.keys(this.datas[0].data),this.hasMorePagesT=!0):this.hasMorePagesT=!1,this.spinnerService.hide()},s=>{(s.status===422||s.status===500)&&s.error&&s.error.data&&s.error.data.payload&&s.error.data.payload.forEach(m=>{let ne=m.propertyPath,se=m.valExceptionDescription;this.pageRequestForm.get(ne)?.setErrors({invalid:!0,customError:se})}),this.spinnerService.hide()})}onSubmit(){if(this.pageRequestForm.valid){let e=this.pageRequestForm.value;this.spinnerService.show(),this.supportService.savePage(e).subscribe(t=>{this.modalRepository.showToast("success","Save Succes","Succes"),this.pageRequestForm.reset(),setTimeout(()=>{window.location.reload()},600),this.spinnerService.hide()},t=>{(t.status===422||t.status===500)&&t.error&&t.error.data&&t.error.data.payload&&t.error.data.payload.forEach(i=>{let n=i.propertyPath,s=i.valExceptionDescription;this.pageRequestForm.get(n)?.setErrors({invalid:!0,customError:s})}),this.spinnerService.hide()}),console.log("Form values:",e)}}handleDeleteAction(e){if(console.log("Deleting:",e.data),e.data.ID!==void 0){let t=e.data.ID;this.supportService.deletePages(t).subscribe(i=>{let n="success";this.pageRequestForm.reset(),this.spinnerService.hide(),this.findPagesProcess()},i=>{(i.status===422||i.status===500)&&i.error&&i.error.data&&i.error.data.payload&&i.error.data.payload.forEach(n=>{let s=n.propertyPath,m=n.valExceptionDescription;this.pageRequestForm.get(s)?.setErrors({invalid:!0,customError:m})}),this.spinnerService.hide()})}}onPageChange(e){this.page=e,this.findByDefualt()}onPageSizeChange(e){}checkInputs(){let e=this.pageRequestForm.get("idToFind")?.value||"",t=this.pageRequestForm.get("titleToFind")?.value||"",i=this.pageRequestForm.get("contentToFind")?.value||"",n=this.pageRequestForm.get("urlToFind")?.value||"";this.searchButtonDisabled=!(e||t||i||n),this.searchButtonDisabled&&(this.page=h.page,this.typeOfSearch=h.typeSearchDefault,this.findPagesProcess())}findByparameter(){this.listError=this.validateObjectID(),this.listError.length===0&&(this.pageRequestForm.get("idToFind")?.markAsTouched(),this.page=h.page,this.pageSize=h.perPage,this.typeOfSearch=h.typeSearchEspecific,this.findPagesProcess())}findByDefualt(){this.typeOfSearch=h.typeSearchDefault,this.findPagesProcess()}validateObjectID(){let e=this.pageRequestForm.get("idToFind")?.value||"",t=[],i=I.isValidObjectId(e);return I.empty(e)||i||t.push("ID is not valid."),t}static \u0275fac=function(t){return new(t||o)(u(j),u(te),u(Y),u(W),u(ee),u($))};static \u0275cmp=b({type:o,selectors:[["app-register-page"]],features:[N],decls:28,vars:3,consts:[[1,"container"],[3,"ngSubmit","formGroup"],["multi","true"],[1,"form-group"],["type","submit",1,"btn","btn-primary"],["expanded","true","disabled","false"],[1,"row"],[1,"col-md-3","col-sm-6"],[3,"control","errorMessages",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[3,"control","errorMessages"]],template:function(t,i){if(t&1&&(a(0,"div",0)(1,"form",1),D("ngSubmit",function(){return i.onSubmit()}),a(2,"nb-accordion",2)(3,"nb-accordion-item")(4,"nb-accordion-item-header"),c(5," Register New Page "),r(),a(6,"nb-accordion-item-body")(7,"div",3)(8,"button",4),c(9,"Save"),r()()()(),a(10,"nb-accordion-item",5)(11,"nb-accordion-item-header"),c(12," Search Information "),r(),a(13,"nb-accordion-item-body")(14,"div",6)(15,"div",7)(16,"div",3),g(17,ge,1,2,"app-validation-message",8),r()(),a(18,"div",7),v(19,"div",3),r(),a(20,"div",7),v(21,"div",3),r(),a(22,"div",7),v(23,"div",3),r(),a(24,"div",7)(25,"div",3)(26,"button",9),D("click",function(){return i.findByparameter()}),c(27,"Search"),r()()()()()()()()()),t&2){let n;p(),l("formGroup",i.pageRequestForm),p(16),l("ngIf",(n=i.pageRequestForm.get("idToFind"))==null?null:n.value),p(9),l("disabled",i.searchButtonDisabled)}},dependencies:[S,y,A,V,O,B,X,J,M,z,G,K,k,C,U,H,Q,L,w,F],encapsulation:2})};export{oe as RegisterPageComponent};
