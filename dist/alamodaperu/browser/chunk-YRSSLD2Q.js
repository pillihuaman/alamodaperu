import{a as ee}from"./chunk-2ZX65H3W.js";import{a as h}from"./chunk-TPLC5BAK.js";import{a as te}from"./chunk-WZ4HYLJP.js";import"./chunk-6ZZGLH3B.js";import"./chunk-GJEU6FZM.js";import{a as Z}from"./chunk-WL5WWBSN.js";import{a as X}from"./chunk-4LLEIU5A.js";import{a as Y}from"./chunk-7RSGDUAG.js";import{a as K}from"./chunk-C4MTUD5M.js";import"./chunk-UD265RQP.js";import"./chunk-GGVMM4CI.js";import{a as m}from"./chunk-SM2U5EFL.js";import"./chunk-IWN3UE4Q.js";import{$b as B,Db as S,Dd as H,Ed as V,Fa as s,Gd as x,Hb as N,Hd as W,Ib as I,Id as L,Jb as M,Jd as U,Kb as F,Kd as $,Md as q,Nd as Q,Oa as c,Ob as T,Rb as E,Ub as A,a as g,b,bc as k,cc as R,da as u,ed as j,ha as d,jd as z,ka as C,kd as O,ld as w,m as _,na as y,nb as D,p as v,ra as l,rd as G,se as J,v as P,ya as n,za as a}from"./chunk-SX3YOEL3.js";var oe=class f extends Z{constructor(t,i,e,o,r,p){super(i,e,r);this.fb=t;this.productService=o;this.router=p}productForm;datas=[];isLoading=!1;searchButtonDisabled=!0;listError;isdelelete;ngOnInit(){this.buildForm(),this.loadProducts(),this.findProductProcess()}buildForm(){this.productForm=this.fb.group({id:[""],name:["",I.required],category:[""],barcode:[""],price:[""],stock:[""]})}columnMapping(){return{id:"ID",name:"Name",description:"Description",barcode:"Barcode",supplierName:"Supplier",sizes:"Sizes",expirationDate:"Expiration Date",manufacturingDate:"Manufacturing Date",pricing:"Pricing",inventory:"Inventory",category:"Category"}}loadProducts(){this.productService.product$.subscribe(t=>{this.processProductData(t),this.spinnerService.hide()})}processProductData(t){this.datas=this.customizePropertyNames(t,this.columnMapping()),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1)}checkInputs(){let t=this.productForm.get("id")?.value||"",i=this.productForm.get("name")?.value||"",e=this.productForm.get("category")?.value||"",o=this.productForm.get("barcode")?.value||"";this.searchButtonDisabled=!(t||i||e||o),this.searchButtonDisabled&&this.findProductProcess()}findProductProcess(){this.spinnerService.show();let t=this.productForm.value.id||"",i=this.productForm.value.name||"",e=this.productForm.value.category||"",o=this.productForm.value.barcode||"";this.productService.findProducts(this.page,this.pageSize,t,i,e,o).pipe(v(r=>{let p=r?.payload||[];return this.customizePropertyNames(p,this.columnMapping())}),P(r=>(console.error("Error fetching employees:",r),_([])))).subscribe(r=>{this.datas=r,console.log("Data source page",this.datas),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1),this.spinnerService.hide()})}findByparameter(){this.listError=this.validateObjectID(),this.listError.length===0&&(this.productForm.get("id")?.markAsTouched(),this.page=m.page,this.pageSize=m.perPage,this.findProductProcess())}validateObjectID(){let t=this.productForm.get("id")?.value||"",i=[],e=h.isValidObjectId(t);return h.empty(t)||e||i.push("ID is not valid."),i}onNewClick(){this.router.navigate(["/support/product/detail","new"])}handleEditAction(t){if(!t?.data?.ID){console.warn("Invalid product data.");return}let i=t.data.ID;this.router.navigate(["support/product/detail",i])}handleDeleteAction(t){debugger;if(console.log("Deleting:",t),t.data.ID!==void 0){let i=t.data.ID;this.productService.deleteProduct(i).subscribe(e=>{this.showSuccessMessage("Delete Success","Success"),this.isdelelete=t},e=>{(e.status===422||e.status===500)&&e.error&&e.error.data&&e.error.data.payload&&e.error.data.payload.forEach(o=>{let r=o.propertyPath,p=o.valExceptionDescription;this.productForm.get(r)?.setErrors({invalid:!0,customError:p})}),this.spinnerService.hide()})}}deleting(t){this.dialogService.open(X,{context:{rowData:b(g({},t.data),{typeDescription:"QUESTION",description:`"${t.data.Name}"?`})}}).onClose.subscribe(e=>{e==="deleteConfirmed"&&(this.handleDeleteAction(t),this.findProductProcess())})}static \u0275fac=function(i){return new(i||f)(d(B),d(K),d(Y),d(te),d(q),d(S))};static \u0275cmp=C({type:f,selectors:[["app-product"]],features:[y],decls:23,vars:6,consts:[[1,"form-container"],[3,"formGroup"],["multi","true"],["expanded","true"],[1,"form-grid"],["nbInput","","fullWidth","","type","text","placeholder","ID","formControlName","id",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Name","formControlName","name",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Category","formControlName","category",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Barcode","formControlName","barcode",3,"input"],[1,"button-container"],["nbButton","","status","primary",3,"click","disabled"],["nbButton","","status","success",3,"click"],[3,"pageChange","pageSizeChange","deleteAction","editAction","loadMoreData","noData","datas","defaultColumns","isdelelete","hasMorePages"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"form",1)(2,"nb-accordion",2)(3,"nb-accordion-item",3)(4,"nb-accordion-item-header"),c(5," Product "),a(),n(6,"nb-accordion-item-body")(7,"div",4)(8,"input",5),s("input",function(){return e.checkInputs()}),a(),n(9,"input",6),s("input",function(){return e.checkInputs()}),a(),n(10,"input",7),s("input",function(){return e.checkInputs()}),a(),n(11,"input",8),s("input",function(){return e.checkInputs()}),a()(),n(12,"div",9)(13,"button",10),s("click",function(){return e.findByparameter()}),c(14," Search "),a(),n(15,"button",11),s("click",function(){return e.onNewClick()}),c(16," New "),a()()()()(),n(17,"nb-accordion",2)(18,"nb-accordion-item",3)(19,"nb-accordion-item-header"),c(20," Data Information "),a(),n(21,"nb-accordion-item-body")(22,"app-table-datasource",12),s("pageChange",function(r){return e.onPageChange(r)})("pageSizeChange",function(r){return e.onPageSizeChange(r)})("deleteAction",function(r){return e.deleting(r)})("editAction",function(r){return e.handleEditAction(r)})("loadMoreData",function(){return e.findProductProcess()})("noData",function(){return e.showNoDataMessage()}),a()()()()()()),i&2&&(u(),l("formGroup",e.productForm),u(12),l("disabled",e.searchButtonDisabled),u(9),l("datas",e.datas)("defaultColumns",e.defaultColumnsInput)("isdelelete",e.isdelelete)("hasMorePages",e.hasMorePagesT))},dependencies:[D,R,T,N,M,F,E,A,k,w,O,z,V,H,j,Q,G,$,x,W,U,L,J,ee],styles:[".form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}"]})};export{oe as ProductComponent};
