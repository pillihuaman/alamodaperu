import{a as S}from"./chunk-SM2U5EFL.js";import{Ae as ie,Da as d,Ea as l,Fa as C,Ga as T,Ge as re,Ha as h,Ia as D,Ka as b,La as r,Md as j,Pa as E,Q as N,Qa as I,R as p,Ra as P,S as u,Sa as v,Ta as m,Va as g,Y as f,ae as z,be as B,fb as y,ha as o,ka as O,kd as $,la as w,ld as H,me as x,nd as R,ne as L,oa as G,ob as M,oe as Q,pb as k,pd as A,pe as K,qe as q,rd as F,re as J,se as U,ta as s,te as W,ub as V,ue as X,ve as Y,wa as c,we as Z,xe as ee,ye as te,ze as ne}from"./chunk-V3AJZABF.js";var oe=["tableHeader"];function le(n,t){n&1&&C(0,"tr",23,1)}function ce(n,t){n&1&&C(0,"tr",24)}function de(n,t){n&1&&(d(0,"th",25),m(1,"Acciones"),l())}function _e(n,t){if(n&1){let e=D();d(0,"td",26)(1,"nb-icon",27),b("click",function(){let a=p(e).$implicit,_=r(3);return u(_.onEdit(a))}),l(),d(2,"nb-icon",28),b("click",function(){let a=p(e).$implicit,_=r(3);return u(_.onDelete(a))}),l()()}}function se(n,t){if(n&1){let e=D();d(0,"th",31),b("click",function(){p(e);let a=r().$implicit,_=r(3);return u(_.updateSort({column:a,direction:_.getNextSortDirection(a)}))}),m(1),C(2,"nb-icon",32),l()}if(n&2){let e=r().$implicit,i=r(3);c("nbSortHeader",e),o(),g(" ",e," "),o(),c("icon",i.getSortIcon(e))}}function me(n,t){if(n&1&&(d(0,"div")(1,"strong"),m(2),l(),m(3),l()),n&2){let e=t.$implicit,i=r(2).$implicit;o(2),g("",e,":"),o(),g(" ",i[e]," ")}}function pe(n,t){if(n&1&&(d(0,"div"),s(1,me,4,2,"div",36),C(2,"hr"),l()),n&2){let e=r().$implicit,i=r(6);o(),c("ngForOf",i.objectKeys(e))}}function ue(n,t){if(n&1&&(d(0,"div"),m(1),l()),n&2){let e=r().$implicit;o(),g(" ",e," ")}}function be(n,t){if(n&1&&(d(0,"div",35),s(1,pe,3,1,"div",5)(2,ue,2,1,"div",5),l()),n&2){let e=t.$implicit,i=r(6);o(),c("ngIf",i.isObject(e)),o(),c("ngIf",!i.isObject(e))}}function ge(n,t){if(n&1&&(T(0),s(1,be,3,2,"div",34),h()),n&2){let e=r().$implicit,i=r().$implicit;o(),c("ngForOf",e.data[i])}}function Ce(n,t){if(n&1&&(d(0,"div")(1,"strong"),m(2),l(),m(3),l()),n&2){let e=t.$implicit,i=r(3).$implicit,a=r().$implicit;o(2),g("",e,":"),o(),g(" ",i.data[a][e]," ")}}function fe(n,t){if(n&1&&(d(0,"div"),s(1,Ce,4,2,"div",36),l()),n&2){let e=r(2).$implicit,i=r().$implicit,a=r(3);o(),c("ngForOf",a.objectKeys(e.data[i]))}}function xe(n,t){if(n&1&&(T(0),d(1,"span",37),m(2),l(),h()),n&2){let e=r(3).$implicit,i=r().$implicit,a=r(3);o(),c("nbTooltip",a.getTooltipText(e.data[i])),o(),g(" ",a.getFirstFieldValue(e.data[i])||"-"," ")}}function Te(n,t){if(n&1&&(d(0,"span",37),m(1),l()),n&2){let e=r(3).$implicit,i=r().$implicit;c("nbTooltip",e.data[i]),o(),g(" ",e.data[i]||"-"," ")}}function he(n,t){if(n&1&&s(0,xe,3,2,"ng-container",8)(1,Te,2,2,"ng-template",null,4,y),n&2){let e=v(2),i=r(2).$implicit,a=r().$implicit,_=r(3);c("ngIf",_.isObject(i.data[a]))("ngIfElse",e)}}function De(n,t){if(n&1&&s(0,fe,2,1,"div",8)(1,he,3,2,"ng-template",null,3,y),n&2){let e=v(2),i=r().$implicit,a=r().$implicit,_=r(3);c("ngIf",_.isObject(i.data[a]))("ngIfElse",e)}}function ve(n,t){if(n&1&&(d(0,"td",33),s(1,ge,2,1,"ng-container",8)(2,De,3,2,"ng-template",null,2,y),l()),n&2){let e=t.$implicit,i=v(3),a=r().$implicit,_=r(3);o(),c("ngIf",_.isArray(e.data[a]))("ngIfElse",i)}}function ye(n,t){if(n&1&&(T(0,12),s(1,se,3,3,"th",29)(2,ve,4,2,"td",30),h()),n&2){let e=t.$implicit;c("nbTreeGridColumnDef",e)}}function we(n,t){if(n&1){let e=D();d(0,"div")(1,"table",9),b("sort",function(a){p(e);let _=r(2);return u(_.updateSort(a))}),s(2,le,2,0,"tr",10)(3,ce,1,0,"tr",11),T(4,12),s(5,de,2,0,"th",13)(6,_e,3,0,"td",14),h(),s(7,ye,3,1,"ng-container",15),l(),d(8,"div",16)(9,"button",17),b("click",function(){p(e);let a=r(2);return u(a.onLoadMore())}),C(10,"nb-icon",18),l(),d(11,"button",19),b("click",function(){p(e);let a=r(2);return u(a.onPageChange(a.currentPage-1))}),C(12,"nb-icon",20),l(),d(13,"span"),m(14),l(),d(15,"button",19),b("click",function(){p(e);let a=r(2);return u(a.onPageChange(a.currentPage+1))}),C(16,"nb-icon",21),l(),d(17,"button",17),b("click",function(){p(e);let a=r(2);return u(a.onLoadMore())}),C(18,"nb-icon",22),l()()()}if(n&2){let e=r(2);o(),c("nbTreeGrid",e.dataSource)("nbSort",e.dataSource),o(),c("nbTreeGridHeaderRowDef",e.getHeaderColumns()),o(),c("nbTreeGridRowDefColumns",e.getRowColumns()),o(),c("nbTreeGridColumnDef","acciones"),o(3),c("ngForOf",e.defaultColumns),o(4),c("disabled",e.currentPage===1),o(3),g("Page ",e.currentPage,""),o(),c("disabled",e.filteredData.length<=e.currentPage*e.pageSize)}}function Se(n,t){n&1&&(d(0,"div",38)(1,"p"),m(2,"No data available. Please add some entries or adjust your search."),l()())}function Ne(n,t){if(n&1){let e=D();d(0,"nb-card")(1,"nb-card-body")(2,"label",6),m(3,"Search:"),l(),d(4,"input",7),b("input",function(a){p(e);let _=r();return u(_.onSearch(a))}),l(),s(5,we,19,9,"div",8)(6,Se,3,0,"ng-template",null,0,y),l()()}if(n&2){let e=v(7),i=r();o(5),c("ngIf",i.filteredData.length>0)("ngIfElse",e)}}var ae=class n{constructor(t,e){this.dataSourceBuilder=t;this.renderer=e;this.dataSource=this.dataSourceBuilder.create([])}defaultColumns=[];datas;typeOfSearch;isdelelete;hasMorePages=!0;pageChange=new f;pageSizeChange=new f;dataChange=new f;deleteAction=new f;editAction=new f;noData=new f;loadMoreData=new f;tableHeader;allColumns=["acciones",...this.defaultColumns];dataSource;filteredDataSource=[];sortColumn;sortDirection=x.NONE;pageSize=S.pageSizeTable;currentPage=S.currentPageTable;allData=[];filteredData=[];paginatedData=[];showTable=!1;searchTerm="";ngOnInit(){this.initializeData()}ngOnChanges(t){t.datas?.currentValue&&this.updateTableData(),this.isdelelete?.data?.ID!==void 0&&this.deleteItem()}initializeData(){this.allData=[...this.datas||[]],this.filteredData=[...this.datas||[]],this.buildTable()}updateTableData(){this.allData=[...this.datas||[]],this.filteredData=[...this.datas||[]],this.showTable=this.datas?.length>0,this.noData.emit(!this.showTable),this.buildTable()}deleteItem(){let t=this.isdelelete.data.ID;this.allData=this.allData.filter(e=>e.data.ID!==t),this.filteredData=this.filteredData.filter(e=>e.data.ID!==t),this.dataChange.emit(this.filteredData),this.buildTable()}buildTable(){let t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;this.paginatedData=this.filteredData.slice(t,e),this.dataSource=this.dataSourceBuilder.create(this.paginatedData)}onSearch(t){let e=t.target;this.searchTerm=e.value.trim().toLowerCase(),this.filteredData=this.searchTerm?this.allData.filter(i=>Object.values(i.data).some(a=>a?.toString().toLowerCase().includes(this.searchTerm))):[...this.allData],this.currentPage=1,this.buildTable()}updateSort(t){this.sortColumn=t.column,this.sortDirection=t.direction}getSortDirection(t){return this.sortColumn===t?this.sortDirection:x.NONE}onEdit(t){this.editAction.emit(t)}onDelete(t){this.deleteAction.emit(t)}onPageChange(t){this.currentPage=t,this.buildTable()}getHeaderColumns(){return[...this.defaultColumns,"acciones"]}getRowColumns(){return[...this.defaultColumns,"acciones"]}getNextSortDirection(t){return this.sortColumn!==t?x.ASCENDING:this.sortDirection===x.ASCENDING?x.DESCENDING:x.NONE}getSortIcon(t){return this.sortColumn!==t?"swap-outline":this.sortDirection===x.ASCENDING?"arrow-up-outline":"arrow-down-outline"}onLoadMore(){this.loadMoreData.emit(500)}isArray(t){return Array.isArray(t)}objectKeys(t){return t?Object.keys(t):[]}isObject(t){return t&&typeof t=="object"&&!Array.isArray(t)}getFirstFieldValue(t){let e=Object.keys(t||{});return e.length>0?t[e[0]]:""}getTooltipText(t){return!t||typeof t!="object"?"":Object.entries(t).map(([e,i])=>`${e}: ${i}`).join(`
`)}static \u0275fac=function(e){return new(e||n)(w(K),w(O))};static \u0275cmp=G({type:n,selectors:[["app-table-datasource"]],viewQuery:function(e,i){if(e&1&&E(oe,7),e&2){let a;I(a=P())&&(i.tableHeader=a.first)}},inputs:{defaultColumns:"defaultColumns",datas:"datas",typeOfSearch:"typeOfSearch",isdelelete:"isdelelete",hasMorePages:"hasMorePages"},outputs:{pageChange:"pageChange",pageSizeChange:"pageSizeChange",dataChange:"dataChange",deleteAction:"deleteAction",editAction:"editAction",noData:"noData",loadMoreData:"loadMoreData"},features:[N],decls:1,vars:1,consts:[["noDataTemplate",""],["tableHeader",""],["singleValue",""],["primitiveValue",""],["simpleValue",""],[4,"ngIf"],["for","search",1,"search-label"],["nbInput","","id","search",1,"search-input",3,"input"],[4,"ngIf","ngIfElse"],[3,"sort","nbTreeGrid","nbSort"],["nbTreeGridHeaderRow","",4,"nbTreeGridHeaderRowDef"],["nbTreeGridRow","",4,"nbTreeGridRowDef","nbTreeGridRowDefColumns"],[3,"nbTreeGridColumnDef"],["nbTreeGridHeaderCell","",4,"nbTreeGridHeaderCellDef"],["nbTreeGridCell","","class","actions-cell",4,"nbTreeGridCellDef"],[3,"nbTreeGridColumnDef",4,"ngFor","ngForOf"],[1,"pagination-container"],["nbButton","","ghost","",3,"click"],["icon","rewind-left-outline"],["nbButton","","ghost","",3,"click","disabled"],["icon","chevron-left"],["icon","chevron-right"],["icon","rewind-right-outline"],["nbTreeGridHeaderRow",""],["nbTreeGridRow",""],["nbTreeGridHeaderCell",""],["nbTreeGridCell","",1,"actions-cell"],["icon","edit-outline",3,"click"],["icon","trash-outline",3,"click"],["nbTreeGridHeaderCell","",3,"nbSortHeader","click",4,"nbTreeGridHeaderCellDef"],["nbTreeGridCell","",4,"nbTreeGridCellDef"],["nbTreeGridHeaderCell","",3,"click","nbSortHeader"],[3,"icon"],["nbTreeGridCell",""],["class","list-item",4,"ngFor","ngForOf"],[1,"list-item"],[4,"ngFor","ngForOf"],[1,"truncate",3,"nbTooltip"],[1,"no-data-container"]],template:function(e,i){e&1&&s(0,Ne,8,2,"nb-card",5),e&2&&c("ngIf",i.showTable)},dependencies:[V,M,k,re,F,A,R,j,$,z,q,J,Y,W,te,U,Z,X,ne,ee,L,Q,ie,H,B],styles:["button[nbTreeGridRowToggle][_ngcontent-%COMP%]{background:transparent;border:none;padding:0}.search-label[_ngcontent-%COMP%]{display:block}.search-input[_ngcontent-%COMP%]{margin-bottom:1rem}.nb-tree-grid[_ngcontent-%COMP%], .nb-tree-grid-header[_ngcontent-%COMP%]{height:auto;width:auto}.header[_ngcontent-%COMP%]{text-align:center;background-color:#1485b9;color:#f0f8ff}th.nbTreeGridHeaderCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%], td.nbTreeGridCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%]{width:10%;display:flex;align-items:center}button[nbButton][_ngcontent-%COMP%]{margin-right:.5rem;font-size:.5rem}@media screen and (max-width: 600px){th.nbTreeGridHeaderCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%], td.nbTreeGridCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%]{width:100%}button[nbButton][_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:10px}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px}.no-data-container[_ngcontent-%COMP%]{text-align:center;font-size:16px;font-weight:700;color:#999;margin:20px 0}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:500px}.table-header[_ngcontent-%COMP%]{position:sticky;top:0;background:#1485b9;color:#fff;z-index:100}.table-header[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px;text-align:left;background:#1485b9;color:#fff;font-weight:700}.table-body[_ngcontent-%COMP%]{overflow-y:auto;max-height:350px}.table-body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.nb-tree-grid[_ngcontent-%COMP%]{display:block;overflow-y:auto;max-height:350px}.nb-tree-grid-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:#1485b9;color:#fff}.truncate[_ngcontent-%COMP%]{display:inline-block;max-width:150px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:top}"]})};export{ae as a};
