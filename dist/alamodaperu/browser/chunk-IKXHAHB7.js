import{a as he}from"./chunk-QA622CXO.js";import{a as xe}from"./chunk-IGSJ74VS.js";import"./chunk-J4WYP6TI.js";import{a as Ce}from"./chunk-VVXZNI42.js";import{a as ve}from"./chunk-C4MTUD5M.js";import{b as fe}from"./chunk-TVVRTYFL.js";import"./chunk-SM2U5EFL.js";import"./chunk-HUQJSXFI.js";import{$b as G,Da as e,Ea as t,Fa as l,I as F,Ia as _,Id as te,Jd as ie,Ka as u,Kb as D,Kd as ne,L as E,La as v,Ld as oe,Md as re,Nd as ae,Ob as T,Pb as g,Qb as A,R as C,Rb as z,Rd as le,S as h,Sd as me,Ta as i,Td as de,Ua as S,Ud as ce,Va as b,Vb as j,Vd as se,Wb as R,Xd as pe,Yb as q,Zb as Q,_b as B,ce as ue,de as ge,ee as be,fa as y,gc as L,ha as a,ic as V,jc as U,kd as H,la as f,ld as W,md as $,nd as J,oa as w,ob as O,od as X,pb as N,pd as K,qd as Y,rd as Z,sa as M,sd as ee,ta as x,ub as I,wa as c,yb as k}from"./chunk-V3AJZABF.js";var P=class m{constructor(s,o){this.http=s;this.apiService=o}static \u0275fac=function(o){return new(o||m)(E(k),E(fe))};static \u0275prov=F({token:m,factory:m.\u0275fac,providedIn:"root"})};function ye(m,s){if(m&1&&(e(0,"nb-option",62),i(1),t()),m&2){let o=s.$implicit;c("value",o),a(),S(o)}}function Fe(m,s){if(m&1){let o=_();e(0,"div",46)(1,"div",47),i(2),t(),e(3,"div",48),l(4,"input",49),t(),e(5,"div",50),l(6,"input",51),t(),e(7,"div",52)(8,"nb-select",53),x(9,ye,2,2,"nb-option",54),t()(),e(10,"div",55)(11,"nb-checkbox",56),i(12,"Conjunto Completo"),t()(),e(13,"div",57),l(14,"input",58),t(),e(15,"div",59)(16,"button",60),u("click",function(){let n=C(o).index,d=v();return h(d.eliminarItem(n))}),l(17,"nb-icon",61),t()()()}if(m&2){let o=s.index,r=v();c("formGroupName",o),a(2),S(o+1),a(7),c("ngForOf",r.tallasDisponibles),a(7),c("disabled",r.items.length===1)}}function we(m,s){if(m&1){let o=_();e(0,"div",63),l(1,"img",64),e(2,"button",65),u("click",function(){C(o);let n=v();return h(n.eliminarLogo())}),l(3,"nb-icon",66),t()()}if(m&2){let o=v();a(),c("src",o.logoPreviewUrl,y)}}function Me(m,s){if(m&1){let o=_();e(0,"div",63),l(1,"img",67),e(2,"button",65),u("click",function(){let n=C(o).index,d=v();return h(d.eliminarImagenReferencia(n))}),l(3,"nb-icon",66),t()()}if(m&2){let o=s.$implicit,r=s.index;a(),c("src",o.url,y)("alt","Referencia "+r)}}function Oe(m,s){m&1&&(e(0,"div",68),l(1,"nb-icon",69),e(2,"p"),i(3,"Tus im\xE1genes aparecer\xE1n aqu\xED"),t()())}var _e=class m extends xe{constructor(o,r,n,d,p,Se){super(Se,d,p);this.fb=o;this.router=r}searchForm;quotationForm;tallasDisponibles=["S","M","L","XL","XXL","6","8","10","12","14","16"];precioConjuntoCompleto=65;precioSoloPolo=45;costoDisenoPorPrenda=25;cantidadTotalPrendas=0;subtotalPrendas=0;totalDiseno=0;granTotal=0;logoFile=null;imagenesReferencia=[];maxImagenes=4;logoPreviewUrl=null;referenciaPreviews=[];ngOnInit(){this.buildForm(),this.quotationForm.valueChanges.subscribe(()=>{this.recalcularTotales()})}buildForm(){this.quotationForm=this.fb.group({clienteNombre:["",g.required],clienteEmail:["",[g.required,g.email]],items:this.fb.array([])}),this.agregarItem()}get items(){return this.quotationForm.get("items")}crearItem(){return this.fb.group({nombre:["",g.required],numeroCamisa:[null],talla:["M",g.required],cantidad:[1,[g.required,g.min(1)]],esConjuntoCompleto:[!0,g.required]})}agregarItem(){this.items.push(this.crearItem())}eliminarItem(o){this.items.length>1&&this.items.removeAt(o)}recalcularTotales(){let o=this.items.value;this.cantidadTotalPrendas=o.reduce((r,n)=>r+(n.cantidad||0),0),this.subtotalPrendas=o.reduce((r,n)=>{let d=n.esConjuntoCompleto?this.precioConjuntoCompleto:this.precioSoloPolo;return r+d*(n.cantidad||0)},0),this.totalDiseno=this.cantidadTotalPrendas*this.costoDisenoPorPrenda,this.granTotal=this.subtotalPrendas+this.totalDiseno}enviarCotizacion(){if(this.quotationForm.invalid){this.quotationForm.markAllAsTouched(),alert("Por favor, completa todos los campos requeridos.");return}let o=new FormData;o.append("cotizacionData",JSON.stringify(this.quotationForm.value)),this.logoFile&&o.append("logo",this.logoFile,this.logoFile.name),this.imagenesReferencia.forEach((r,n)=>{o.append(`referencia_${n}`,r,r.name)}),console.log("Enviando FormData al backend..."),alert("\xA1Cotizaci\xF3n enviada con \xE9xito!")}onLogoSelect(o){let r=o.target;if(r.files&&r.files[0]){this.logoFile=r.files[0];let n=new FileReader;n.onload=()=>{this.logoPreviewUrl=n.result},n.readAsDataURL(this.logoFile)}}onReferenciaSelect(o){let r=o.target;if(r.files){let n=Array.from(r.files);if(this.referenciaPreviews.length+n.length>this.maxImagenes){alert(`No puedes subir m\xE1s de ${this.maxImagenes} im\xE1genes de referencia.`);return}n.forEach(d=>{this.imagenesReferencia.push(d);let p=new FileReader;p.onload=()=>{this.referenciaPreviews.push({file:d,url:p.result})},p.readAsDataURL(d)})}}eliminarImagenReferencia(o){this.imagenesReferencia.splice(o,1),this.referenciaPreviews.splice(o,1)}eliminarLogo(){this.logoFile=null,this.logoPreviewUrl=null;let o=document.getElementById("logo-input");o&&(o.value="")}static \u0275fac=function(r){return new(r||m)(f(L),f(D),f(P),f(Ce),f(pe),f(ve))};static \u0275cmp=w({type:m,selectors:[["quotation-create"]],features:[M],decls:144,vars:17,consts:[["status","info","closable","true",1,"mb-4"],[1,"alert-title"],[1,"alert-text"],[3,"formGroup"],[1,"section-title"],[1,"info-cliente"],["nbInput","","fullWidth","","placeholder","Nombre del Equipo o Contacto","formControlName","clienteNombre"],["nbInput","","fullWidth","","placeholder","Email de Contacto","formControlName","clienteEmail"],["nbInput","","fullWidth","","placeholder","Tel\xE9fono de Contacto","formControlName","clienteTelefono"],[1,"mb-4"],["icon","ruler-outline"],["src","assets/imgs/guia-tallas-completa.jpg","alt","Gu\xEDa de tallas para polos y shorts",1,"guia-tallas-img"],[1,"quotation-grid"],[1,"grid-header"],[1,"header-item"],["formArrayName","items"],["class","grid-row",3,"formGroupName",4,"ngFor","ngForOf"],["nbButton","","status","success",1,"add-row-button",3,"click"],["icon","plus-outline"],[1,"additional-info-grid"],[1,"info-section"],["nbInput","","fullWidth","","rows","10","placeholder","Ej: Quiero el logo en el pecho izquierdo, n\xFAmero en la espalda en color dorado, y el short azul marino.","formControlName","descripcionDetallada"],["for","logo-input",1,"file-input-label"],["icon","upload-outline"],["id","logo-input","type","file","accept","image/*,.pdf,.ai,.cdr",1,"file-input-hidden",3,"change"],["for","ref-input",1,"file-input-label"],["id","ref-input","type","file","multiple","","accept","image/*",1,"file-input-hidden",3,"change","disabled"],[1,"info-section","preview-section"],[1,"previews-wrapper"],["class","preview-box",4,"ngIf"],["class","preview-box",4,"ngFor","ngForOf"],["class","no-preview-placeholder",4,"ngIf"],[1,"footer-container"],[1,"summary-section"],[1,"summary-item","precios-base"],[1,"summary-item"],[1,"summary-item","total"],[1,"terms-section"],[1,"terms-title"],[1,"terms-list"],["icon","checkmark-circle-2-outline","status","success"],["icon","clock-outline","status","info"],["icon","car-outline","status","primary"],["nbButton","","status","primary","hero","",1,"mt-3",3,"click","disabled"],["nbButton","","status","primary","hero","",3,"click","disabled"],[3,"context"],[1,"grid-row",3,"formGroupName"],["data-label","N\xB0",1,"grid-cell"],["data-label","Nombre",1,"grid-cell"],["nbInput","","fullWidth","","type","text","formControlName","nombre"],["data-label","N\xFAmero",1,"grid-cell"],["nbInput","","fullWidth","","type","number","formControlName","numeroCamisa"],["data-label","Talla",1,"grid-cell"],["fullWidth","","formControlName","talla"],[3,"value",4,"ngFor","ngForOf"],["data-label","Tipo",1,"grid-cell","tipo-prenda"],["formControlName","esConjuntoCompleto"],["data-label","Cantidad",1,"grid-cell"],["nbInput","","fullWidth","","type","number","formControlName","cantidad"],["data-label","Acci\xF3n",1,"grid-cell"],["nbButton","","ghost","","status","danger","size","small",3,"click","disabled"],["icon","trash-2-outline"],[3,"value"],[1,"preview-box"],["alt","Previsualizaci\xF3n del logo",1,"preview-image",3,"src"],["nbButton","","status","danger","size","tiny",1,"delete-preview-btn",3,"click"],["icon","close-outline"],[1,"preview-image",3,"src","alt"],[1,"no-preview-placeholder"],["icon","image-outline"]],template:function(r,n){r&1&&(e(0,"nb-card")(1,"nb-card-header")(2,"h2"),i(3,"Cotizaci\xF3n de Conjuntos Deportivos"),t(),e(4,"p"),i(5,"Completa los datos para generar tu cotizaci\xF3n personalizada."),t()(),e(6,"nb-card-body")(7,"nb-alert",0)(8,"h6",1),i(9,"\xA1Atenci\xF3n! Cotizaci\xF3n Preliminar"),t(),e(10,"p",2),i(11," Este es un c\xE1lculo estimado. El precio final puede variar ligeramente seg\xFAn la complejidad del dise\xF1o. Nos pondremos en contacto contigo para confirmar todos los detalles. "),t()(),e(12,"form",3)(13,"h5",4),i(14,"1. Datos de Contacto"),t(),e(15,"div",5),l(16,"input",6)(17,"input",7)(18,"input",8),t(),e(19,"nb-accordion",9)(20,"nb-accordion-item")(21,"nb-accordion-item-header"),l(22,"nb-icon",10),i(23," \xBFNo est\xE1s seguro de las tallas? Consulta nuestra gu\xEDa "),t(),e(24,"nb-accordion-item-body"),l(25,"img",11),t()()(),e(26,"h5",4),i(27,"2. Lista de Jugadores y Prendas"),t(),e(28,"div",12)(29,"div",13)(30,"div",14),i(31,"N\xB0"),t(),e(32,"div",14),i(33,"Nombre"),t(),e(34,"div",14),i(35,"N\xFAmero"),t(),e(36,"div",14),i(37,"Talla"),t(),e(38,"div",14),i(39,"Tipo"),t(),e(40,"div",14),i(41,"Cantidad"),t(),e(42,"div",14),i(43,"Acci\xF3n"),t()(),e(44,"div",15),x(45,Fe,18,4,"div",16),t()(),e(46,"button",17),u("click",function(){return n.agregarItem()}),l(47,"nb-icon",18),i(48,"A\xF1adir Jugador "),t(),e(49,"h5",4),i(50,"3. Detalles y Archivos del Dise\xF1o"),t(),e(51,"div",19)(52,"div",20)(53,"h6"),i(54,"Descripci\xF3n detallada"),t(),l(55,"textarea",21),t(),e(56,"div",20)(57,"h6"),i(58,"Archivos de Referencia"),t(),e(59,"label",22),l(60,"nb-icon",23),e(61,"span"),i(62,"Subir Logo del Equipo"),t()(),e(63,"input",24),u("change",function(p){return n.onLogoSelect(p)}),t(),e(64,"label",25),l(65,"nb-icon",23),e(66,"span"),i(67),t()(),e(68,"input",26),u("change",function(p){return n.onReferenciaSelect(p)}),t()(),e(69,"div",27)(70,"h6"),i(71,"Previsualizaci\xF3n"),t(),e(72,"div",28),x(73,we,4,1,"div",29)(74,Me,4,2,"div",30)(75,Oe,4,0,"div",31),t()()()()(),e(76,"nb-card-footer")(77,"div",32)(78,"div",33)(79,"h4"),i(80,"Resumen de la Cotizaci\xF3n"),t(),e(81,"div",34)(82,"span"),i(83,"Precio por Conjunto Completo:"),t(),e(84,"strong"),i(85),t()(),e(86,"div",34)(87,"span"),i(88,"Precio por Solo Polo:"),t(),e(89,"strong"),i(90),t()(),e(91,"div",35)(92,"span"),i(93,"Costo de Dise\xF1o y Sublimado (por prenda):"),t(),e(94,"strong"),i(95),t()(),l(96,"hr"),e(97,"div",35)(98,"span"),i(99,"Cantidad Total de Prendas:"),t(),e(100,"strong"),i(101),t()(),e(102,"div",35)(103,"span"),i(104,"Subtotal (Costo de Prendas):"),t(),e(105,"strong"),i(106),t()(),e(107,"div",35)(108,"span"),i(109,"Total (Dise\xF1o y Sublimado):"),t(),e(110,"strong"),i(111),t()(),e(112,"div",36)(113,"span"),i(114,"GRAN TOTAL:"),t(),e(115,"strong"),i(116),t()()(),e(117,"div",37)(118,"h6",38),i(119,"Condiciones de Nuestro Servicio"),t(),e(120,"ul",39)(121,"li"),l(122,"nb-icon",40),e(123,"span")(124,"strong"),i(125,"Garant\xEDa y Pago:"),t(),i(126," Se requiere un adelanto del 50% para iniciar la producci\xF3n. El 50% restante se paga al momento del env\xEDo o entrega."),t()(),e(127,"li"),l(128,"nb-icon",41),e(129,"span")(130,"strong"),i(131,"Tiempo de Producci\xF3n:"),t(),i(132," Desde 3 d\xEDas h\xE1biles, dependiendo de la cantidad y complejidad del pedido."),t()(),e(133,"li"),l(134,"nb-icon",42),e(135,"span")(136,"strong"),i(137,"Env\xEDos a Nivel Nacional:"),t(),i(138," Realizamos env\xEDos a todo el Per\xFA (costo de env\xEDo no incluido)."),t()()(),e(139,"button",43),u("click",function(){return n.enviarCotizacion()}),i(140," Acepto las condiciones y deseo cotizar "),t()(),e(141,"button",44),u("click",function(){return n.enviarCotizacion()}),i(142," Generar y Enviar Cotizaci\xF3n "),t()(),l(143,"app-chatbot",45),t()()),r&2&&(a(12),c("formGroup",n.quotationForm),a(33),c("ngForOf",n.items.controls),a(22),b("Subir Im\xE1genes del Dise\xF1o (",n.maxImagenes,")"),a(),c("disabled",n.referenciaPreviews.length>=n.maxImagenes),a(5),c("ngIf",n.logoPreviewUrl),a(),c("ngForOf",n.referenciaPreviews),a(),c("ngIf",!n.logoPreviewUrl&&n.referenciaPreviews.length===0),a(10),b("S/ ",n.precioConjuntoCompleto.toFixed(2),""),a(5),b("S/ ",n.precioSoloPolo.toFixed(2),""),a(5),b("S/ ",n.costoDisenoPorPrenda.toFixed(2),""),a(6),S(n.cantidadTotalPrendas),a(5),b("S/ ",n.subtotalPrendas.toFixed(2),""),a(5),b("S/ ",n.totalDiseno.toFixed(2),""),a(5),b("S/ ",n.granTotal.toFixed(2),""),a(23),c("disabled",n.quotationForm.invalid),a(2),c("disabled",n.quotationForm.invalid),a(2),c("context","cotizacion-sublimado"))},dependencies:[I,O,N,U,j,T,R,A,z,q,G,Q,B,V,ee,Z,Y,K,J,X,$,ae,re,W,H,be,ge,ue,ie,te,se,le,me,ce,de,oe,ne,he],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}.section-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-top:2.5rem;margin-bottom:1.5rem;padding-bottom:.5rem;border-bottom:2px solid var(--border-basic-color-3)}.section-title[_ngcontent-%COMP%]:first-of-type{margin-top:0}h6[_ngcontent-%COMP%]{font-weight:500;margin-bottom:1rem}.mb-4[_ngcontent-%COMP%]{margin-bottom:2rem}.info-cliente[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.add-row-button[_ngcontent-%COMP%]{margin-top:1rem}.guia-tallas-img[_ngcontent-%COMP%]{max-width:100%;height:auto;border-radius:var(--card-border-radius)}.tipo-prenda[_ngcontent-%COMP%]   nb-checkbox[_ngcontent-%COMP%]{width:100%}@media (min-width: 992px){.grid-header[_ngcontent-%COMP%], .grid-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:40px 3fr 1fr 1.5fr 2fr 1fr 1fr;gap:1.5rem;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--border-basic-color-3)}.grid-header[_ngcontent-%COMP%]{font-weight:600;background-color:var(--background-basic-color-2)}.grid-cell[_ngcontent-%COMP%]:before{display:none}}.additional-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1.5fr 1.5fr 1.2fr;gap:2rem}.file-input-hidden[_ngcontent-%COMP%]{display:none}.file-input-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;width:100%;padding:.75rem;margin-bottom:1.5rem;background-color:var(--background-basic-color-2);border:1px solid var(--border-basic-color-4);border-radius:var(--button-border-radius);cursor:pointer;transition:background-color .2s,border-color .2s}.file-input-label[_ngcontent-%COMP%]:hover{background-color:var(--background-basic-color-3);border-color:var(--color-primary-500)}.preview-section[_ngcontent-%COMP%]{background-color:var(--background-basic-color-2);border-radius:var(--card-border-radius);padding:1rem 1.5rem;height:fit-content}.previews-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));gap:1rem}.preview-box[_ngcontent-%COMP%]{position:relative;aspect-ratio:1/1}.preview-box[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:var(--button-border-radius);border:1px solid var(--border-basic-color-3)}.preview-box[_ngcontent-%COMP%]   .delete-preview-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;border-radius:50%;box-shadow:var(--shadow);--button-ghost-background-color: var(--background-basic-color-1);--button-ghost-border-color: var(--border-basic-color-4)}.no-preview-placeholder[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;min-height:150px;color:var(--text-hint-color);border:2px dashed var(--border-basic-color-3);border-radius:var(--card-border-radius)}.no-preview-placeholder[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:.5rem}.footer-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:2rem;width:100%}.summary-section[_ngcontent-%COMP%]{flex-grow:1;max-width:450px}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0}.summary-item.precios-base[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-hint-color)}.summary-item.total[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--color-primary-500);border-top:2px solid var(--border-basic-color-3);margin-top:.5rem;padding-top:1rem}@media (max-width: 1200px){.additional-info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.preview-section[_ngcontent-%COMP%]{grid-column:1/-1;margin-top:1rem}}@media (max-width: 991px){.grid-header[_ngcontent-%COMP%]{display:none}.grid-row[_ngcontent-%COMP%]{display:block;border:1px solid var(--border-basic-color-3);border-radius:8px;padding:1rem;margin-bottom:1rem;background-color:var(--background-basic-color-2)}.grid-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.75rem 0;border-bottom:1px solid var(--border-basic-color-3)}.grid-cell[_ngcontent-%COMP%]:last-child{border:none}.grid-cell[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:600;margin-right:1rem;flex-shrink:0}.grid-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-grow:1;max-width:60%}}@media (max-width: 767px){.info-cliente[_ngcontent-%COMP%], .additional-info-grid[_ngcontent-%COMP%], .footer-container[_ngcontent-%COMP%]{flex-direction:column;grid-template-columns:1fr}.summary-section[_ngcontent-%COMP%]{width:100%;max-width:100%;margin-bottom:2rem}}.alert-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem}.alert-text[_ngcontent-%COMP%]{margin-bottom:0;font-size:.9rem}.callout-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.callout-icon[_ngcontent-%COMP%]{font-size:2rem}.terms-section[_ngcontent-%COMP%]{flex-basis:40%;background-color:var(--background-basic-color-2);padding:1.5rem;border-radius:var(--card-border-radius);border:1px solid var(--border-basic-color-3)}.terms-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-top:0;margin-bottom:1rem}.terms-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:1rem}.terms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem}.terms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:1.25rem;margin-top:2px}.mt-3[_ngcontent-%COMP%]{margin-top:1.5rem}@media (max-width: 991px){.footer-container[_ngcontent-%COMP%]{flex-direction:column}.summary-section[_ngcontent-%COMP%], .terms-section[_ngcontent-%COMP%]{width:100%;max-width:100%;flex-basis:auto}}']})};export{_e as QuotationCreateComponent};
