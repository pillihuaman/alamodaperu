import{a as ae}from"./chunk-DMNBPJSE.js";import{a as pe}from"./chunk-TPLC5BAK.js";import"./chunk-GJEU6FZM.js";import{a as ne}from"./chunk-WL5WWBSN.js";import"./chunk-4LLEIU5A.js";import{a as re}from"./chunk-7RSGDUAG.js";import{a as oe}from"./chunk-C4MTUD5M.js";import"./chunk-SM2U5EFL.js";import{$b as G,Aa as s,Bb as x,Bd as K,Da as _,Db as D,Dd as Q,Ed as X,Fa as m,Ga as y,Gb as I,Hb as R,Jb as O,Kb as k,Md as Y,O as g,Oa as a,Ob as A,P as v,Rb as P,Sb as E,Tb as B,Ub as j,Yd as Z,Zd as $,a as h,bc as T,cc as w,da as f,dd as V,ed as W,fd as q,gd as z,ha as p,hb as F,id as L,jd as U,ka as C,kd as H,ld as J,na as S,nb as M,oa as N,oe as ee,ra as u,re as te,se as ie,ya as r,za as n}from"./chunk-SX3YOEL3.js";function se(l,b){if(l&1){let e=_();r(0,"div",18),s(1,"input",3)(2,"input",6)(3,"input",7),r(4,"button",19),m("click",function(){let i=g(e).index,o=y();return v(o.removeContact(i))}),s(5,"nb-icon",20),n()()}if(l&2){let e=b.index;u("formGroupName",e)}}var le=class l extends ne{constructor(e,t,i,o,c,d,me){super(e,t,d);this.fb=i;this.supplierRepository=o;this.router=c;this.activatedRoute=me}supplierForm;reqSupplier;ngOnInit(){this.supplierForm=this.fb.group({id:[""],name:[""],ruc:[""],address:[""],phone:[""],email:[""],status:[!0],contacts:this.fb.array([])}),this.loadSupplierData()}loadSupplierData(){let e=this.activatedRoute.snapshot.paramMap.get("id");if(e&&pe.isValidObjectId(e)&&e){let t={id:e,name:"",address:"",email:"",phone:"",country:"",status:!0,contacts:[],page:1,pagesize:1};this.spinnerService.show(),this.supplierRepository.listSuppliers(t).subscribe({next:i=>{let o=i.length>0?i[0]:null;o?(this.supplierForm.patchValue(o),o.contacts&&o.contacts.length>0&&o.contacts.forEach(c=>{let d=this.fb.group({name:[c.name],phone:[c.phone],email:[c.email]});this.contacts.push(d)})):console.error("Supplier not found"),this.spinnerService.hide()},error:()=>{console.error("Error fetching supplier data"),this.spinnerService.hide()}})}}get contacts(){return this.supplierForm.get("contacts")}addContact(){let e=this.fb.group({name:[""],phone:[""],email:[""]});this.contacts.push(e)}removeContact(e){this.contacts.removeAt(e)}saveSupplier(){let e=h({},this.supplierForm.value);this.supplierRepository.saveSupplier(e).subscribe(t=>{console.log("Supplier saved:",t),this.router.navigate(["/support/supplier"])})}deleteSupplier(){let e=this.supplierForm.get("id")?.value;e&&this.supplierRepository.deleteSupplier(e).subscribe(()=>{console.log("Supplier deleted:",e),this.supplierForm.reset()})}returnToList(){this.router.navigate(["/support/supplier"])}static \u0275fac=function(t){return new(t||l)(p(oe),p(re),p(G),p(ae),p(D),p(Y),p(x))};static \u0275cmp=C({type:l,selectors:[["app-detail-supplier"]],features:[S],decls:28,vars:2,consts:[[3,"formGroup"],[1,"form-grid"],["nbInput","","fullWidth","","placeholder","ID","formControlName","id","readonly",""],["nbInput","","fullWidth","","placeholder","Name","formControlName","name"],["nbInput","","fullWidth","","placeholder","RUC","formControlName","ruc"],["nbInput","","fullWidth","","placeholder","Address","formControlName","address"],["nbInput","","fullWidth","","placeholder","Phone","formControlName","phone"],["nbInput","","fullWidth","","placeholder","Email","formControlName","email"],["formControlName","status"],[1,"contacts-section"],[1,"contacts-header"],["nbButton","","ghost","","size","small","type","button",3,"click"],["icon","plus-outline"],["formArrayName","contacts"],["class","contact-item",3,"formGroupName",4,"ngFor","ngForOf"],[1,"button-container"],["nbButton","","status","primary",3,"click"],["nbButton","","status","danger",3,"click"],[1,"contact-item",3,"formGroupName"],["nbButton","","status","danger","size","small","type","button",3,"click"],["icon","trash-2-outline"]],template:function(t,i){t&1&&(r(0,"nb-card")(1,"nb-card-header"),a(2,"Supplier Detail"),n(),r(3,"nb-card-body")(4,"form",0)(5,"div",1),s(6,"input",2)(7,"input",3)(8,"input",4)(9,"input",5)(10,"input",6)(11,"input",7),n(),r(12,"nb-checkbox",8),a(13,"Active"),n(),r(14,"div",9)(15,"div",10)(16,"h4"),a(17,"Contacts"),n(),r(18,"button",11),m("click",function(){return i.addContact()}),s(19,"nb-icon",12),a(20," Add Contact "),n()(),r(21,"div",13),N(22,se,6,1,"div",14),n()(),r(23,"div",15)(24,"button",16),m("click",function(){return i.saveSupplier()}),a(25,"Save"),n(),r(26,"button",17),m("click",function(){return i.returnToList()}),a(27,"Return"),n()()()()()),t&2&&(f(4),u("formGroup",i.supplierForm),f(18),u("ngForOf",i.contacts.controls))},dependencies:[M,F,I,J,H,U,L,z,q,X,Q,W,V,ie,K,A,R,O,k,P,j,E,B,w,T,$,Z,ee,te],styles:[".button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}.contacts-section[_ngcontent-%COMP%]{margin-top:24px}.contacts-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.contact-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr) 60px;gap:12px;align-items:center;margin-bottom:12px}@media (max-width: 1024px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.contact-item[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr 60px}}@media (max-width: 640px){.form-grid[_ngcontent-%COMP%], .contact-item[_ngcontent-%COMP%]{grid-template-columns:1fr}.contact-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})};export{le as DetailSupplierComponent};
