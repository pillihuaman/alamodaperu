import{a as N}from"./chunk-SGZVPLXZ.js";import{$a as Y,Bd as g,Cd as Q,Da as O,Dd as q,Ea as E,Ed as Z,Fa as I,Fd as J,Ga as H,Gd as K,H as M,Ha as h,Hd as U,I as u,Ia as k,Id as W,J as m,Ja as S,Jd as X,Kd as ee,Ld as te,Md as ne,Nd as ie,Oc as z,Od as re,P as _,Pc as B,Pd as ae,Qd as me,Rc as j,Sd as oe,Ta as R,Tc as $,Td as le,Vc as F,Vd as ce,Z as s,_a as V,aa as G,ba as y,bb as v,da as P,db as A,f as ue,gd as L,ha as C,ka as d,ra as c,sa as o,ta as p,ua as x,va as w,wa as D,ya as b,za as l}from"./chunk-AQOSOR55.js";var be=["tableHeader"];function _e(r,t){r&1&&p(0,"tr",20,1)}function pe(r,t){r&1&&p(0,"tr",21)}function ge(r,t){r&1&&(c(0,"th",22),h(1,"Acciones"),o())}function fe(r,t){if(r&1){let e=D();c(0,"td",23)(1,"nb-icon",24),b("click",function(){let i=u(e).$implicit,a=l(3);return m(a.onEdit(i))}),o(),c(2,"nb-icon",25),b("click",function(){let i=u(e).$implicit,a=l(3);return m(a.onDelete(i))}),o()()}}function Ce(r,t){if(r&1){let e=D();c(0,"th",28),b("click",function(){u(e);let i=l().$implicit,a=l(3);return m(a.updateSort({column:i,direction:a.getNextSortDirection(i)}))}),h(1),p(2,"nb-icon",29),o()}if(r&2){let e=l().$implicit,n=l(3);d("nbSortHeader",e),s(),S(" ",e," "),s(),d("icon",n.getSortIcon(e))}}function he(r,t){if(r&1&&(c(0,"td",30),h(1),o()),r&2){let e=t.$implicit,n=l().$implicit;s(),k(e.data[n]||"-")}}function De(r,t){if(r&1&&(x(0,9),C(1,Ce,3,3,"th",26)(2,he,2,1,"td",27),w()),r&2){let e=t.$implicit;d("nbTreeGridColumnDef",e)}}function Te(r,t){if(r&1){let e=D();c(0,"div")(1,"table",6),b("sort",function(i){u(e);let a=l(2);return m(a.updateSort(i))}),C(2,_e,2,0,"tr",7)(3,pe,1,0,"tr",8),x(4,9),C(5,ge,2,0,"th",10)(6,fe,3,0,"td",11),w(),C(7,De,3,1,"ng-container",12),o(),c(8,"div",13)(9,"button",14),b("click",function(){u(e);let i=l(2);return m(i.onLoadMore())}),p(10,"nb-icon",15),o(),c(11,"button",16),b("click",function(){u(e);let i=l(2);return m(i.onPageChange(i.currentPage-1))}),p(12,"nb-icon",17),o(),c(13,"span"),h(14),o(),c(15,"button",16),b("click",function(){u(e);let i=l(2);return m(i.onPageChange(i.currentPage+1))}),p(16,"nb-icon",18),o(),c(17,"button",14),b("click",function(){u(e);let i=l(2);return m(i.onLoadMore())}),p(18,"nb-icon",19),o()()()}if(r&2){let e=l(2);s(),d("nbTreeGrid",e.dataSource)("nbSort",e.dataSource),s(),d("nbTreeGridHeaderRowDef",e.getHeaderColumns()),s(),d("nbTreeGridRowDefColumns",e.getRowColumns()),s(),d("nbTreeGridColumnDef","acciones"),s(3),d("ngForOf",e.defaultColumns),s(4),d("disabled",e.currentPage===1),s(3),S("Page ",e.currentPage,""),s(),d("disabled",e.filteredData.length<=e.currentPage*e.pageSize)}}function ye(r,t){r&1&&(c(0,"div",31)(1,"p"),h(2,"No data available. Please add some entries or adjust your search."),o()())}function xe(r,t){if(r&1){let e=D();c(0,"nb-card")(1,"nb-card-body")(2,"label",3),h(3,"Search:"),o(),c(4,"input",4),b("input",function(i){u(e);let a=l();return m(a.onSearch(i))}),o(),C(5,Te,19,9,"div",5)(6,ye,3,0,"ng-template",null,0,R),o()()}if(r&2){let e=H(7),n=l();s(5),d("ngIf",n.filteredData.length>0)("ngIfElse",e)}}var se=class r{constructor(t,e){this.dataSourceBuilder=t;this.renderer=e;this.dataSource=this.dataSourceBuilder.create([])}defaultColumns=[];datas;typeOfSearch;isdelelete;hasMorePages=!0;pageChange=new _;pageSizeChange=new _;dataChange=new _;deleteAction=new _;editAction=new _;noData=new _;loadMoreData=new _;tableHeader;allColumns=["acciones",...this.defaultColumns];dataSource;filteredDataSource=[];sortColumn;sortDirection=g.NONE;pageSize=N.pageSizeTable;currentPage=N.currentPageTable;allData=[];filteredData=[];paginatedData=[];showTable=!1;searchTerm="";ngOnInit(){this.initializeData()}ngOnChanges(t){t.datas?.currentValue&&this.updateTableData(),this.isdelelete?.data?.ID!==void 0&&this.deleteItem()}initializeData(){this.allData=[...this.datas||[]],this.filteredData=[...this.datas||[]],this.buildTable()}updateTableData(){this.allData=[...this.datas||[]],this.filteredData=[...this.datas||[]],this.showTable=this.datas?.length>0,this.noData.emit(!this.showTable),this.buildTable()}deleteItem(){let t=this.isdelelete.data.ID;this.allData=this.allData.filter(e=>e.data.ID!==t),this.filteredData=this.filteredData.filter(e=>e.data.ID!==t),this.dataChange.emit(this.filteredData),this.buildTable()}buildTable(){let t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;this.paginatedData=this.filteredData.slice(t,e),this.dataSource=this.dataSourceBuilder.create(this.paginatedData)}onSearch(t){let e=t.target;this.searchTerm=e.value.trim().toLowerCase(),this.filteredData=this.searchTerm?this.allData.filter(n=>Object.values(n.data).some(i=>i?.toString().toLowerCase().includes(this.searchTerm))):[...this.allData],this.currentPage=1,this.buildTable()}updateSort(t){this.sortColumn=t.column,this.sortDirection=t.direction}getSortDirection(t){return this.sortColumn===t?this.sortDirection:g.NONE}onEdit(t){this.editAction.emit(t)}onDelete(t){this.deleteAction.emit(t)}onPageChange(t){this.currentPage=t,this.buildTable()}getHeaderColumns(){return[...this.defaultColumns,"acciones"]}getRowColumns(){return[...this.defaultColumns,"acciones"]}getNextSortDirection(t){return this.sortColumn!==t?g.ASCENDING:this.sortDirection===g.ASCENDING?g.DESCENDING:g.NONE}getSortIcon(t){return this.sortColumn!==t?"swap-outline":this.sortDirection===g.ASCENDING?"arrow-up-outline":"arrow-down-outline"}onLoadMore(){this.loadMoreData.emit(500)}static \u0275fac=function(e){return new(e||r)(y(Z),y(G))};static \u0275cmp=P({type:r,selectors:[["app-table-datasource"]],viewQuery:function(e,n){if(e&1&&O(be,7),e&2){let i;E(i=I())&&(n.tableHeader=i.first)}},inputs:{defaultColumns:"defaultColumns",datas:"datas",typeOfSearch:"typeOfSearch",isdelelete:"isdelelete",hasMorePages:"hasMorePages"},outputs:{pageChange:"pageChange",pageSizeChange:"pageSizeChange",dataChange:"dataChange",deleteAction:"deleteAction",editAction:"editAction",noData:"noData",loadMoreData:"loadMoreData"},features:[M],decls:1,vars:1,consts:[["noDataTemplate",""],["tableHeader",""],[4,"ngIf"],["for","search",1,"search-label"],["nbInput","","id","search",1,"search-input",3,"input"],[4,"ngIf","ngIfElse"],[3,"sort","nbTreeGrid","nbSort"],["nbTreeGridHeaderRow","",4,"nbTreeGridHeaderRowDef"],["nbTreeGridRow","",4,"nbTreeGridRowDef","nbTreeGridRowDefColumns"],[3,"nbTreeGridColumnDef"],["nbTreeGridHeaderCell","",4,"nbTreeGridHeaderCellDef"],["nbTreeGridCell","","class","actions-cell",4,"nbTreeGridCellDef"],[3,"nbTreeGridColumnDef",4,"ngFor","ngForOf"],[1,"pagination-container"],["nbButton","","ghost","",3,"click"],["icon","rewind-left-outline"],["nbButton","","ghost","",3,"click","disabled"],["icon","chevron-left"],["icon","chevron-right"],["icon","rewind-right-outline"],["nbTreeGridHeaderRow",""],["nbTreeGridRow",""],["nbTreeGridHeaderCell",""],["nbTreeGridCell","",1,"actions-cell"],["icon","edit-outline",3,"click"],["icon","trash-outline",3,"click"],["nbTreeGridHeaderCell","",3,"nbSortHeader","click",4,"nbTreeGridHeaderCellDef"],["nbTreeGridCell","",4,"nbTreeGridCellDef"],["nbTreeGridHeaderCell","",3,"click","nbSortHeader"],[3,"icon"],["nbTreeGridCell",""],[1,"no-data-container"]],template:function(e,n){e&1&&C(0,xe,8,2,"nb-card",2),e&2&&d("ngIf",n.showTable)},dependencies:[A,V,Y,ce,F,$,j,L,z,J,K,ee,W,ie,U,te,X,re,ne,Q,q,ae,B],styles:["button[nbTreeGridRowToggle][_ngcontent-%COMP%]{background:transparent;border:none;padding:0}.search-label[_ngcontent-%COMP%]{display:block}.search-input[_ngcontent-%COMP%]{margin-bottom:1rem}.nb-tree-grid[_ngcontent-%COMP%], .nb-tree-grid-header[_ngcontent-%COMP%]{height:auto;width:auto}.header[_ngcontent-%COMP%]{text-align:center;background-color:#1485b9;color:#f0f8ff}th.nbTreeGridHeaderCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%], td.nbTreeGridCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%]{width:10%;display:flex;align-items:center}button[nbButton][_ngcontent-%COMP%]{margin-right:.5rem;font-size:.5rem}@media screen and (max-width: 600px){th.nbTreeGridHeaderCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%], td.nbTreeGridCell[ng-reflect-nbTreeGridColumnDef=acciones][_ngcontent-%COMP%]{width:100%}button[nbButton][_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:10px}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px}.no-data-container[_ngcontent-%COMP%]{text-align:center;font-size:16px;font-weight:700;color:#999;margin:20px 0}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:500px}.table-header[_ngcontent-%COMP%]{position:sticky;top:0;background:#1485b9;color:#fff;z-index:100}.table-header[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table-header[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px;text-align:left;background:#1485b9;color:#fff;font-weight:700}.table-body[_ngcontent-%COMP%]{overflow-y:auto;max-height:350px}.table-body[_ngcontent-%COMP%]   table[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.nb-tree-grid[_ngcontent-%COMP%]{display:block;overflow-y:auto;max-height:350px}.nb-tree-grid-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:100;background:#1485b9;color:#fff}"]})};var T=class{static typeProductClothing="PRODUCTTYPESGENERAL001";static objectIdPattern=/^[0-9a-fA-F]{24}$/};var f=ue(me());var de=class{static getKeysJson(t){let e=[];for(let n of Object.keys(t))e.push(n);return e}static sortDate=(t,e,n)=>{let i=Number(new v("es-PE").transform(e,"YYYY-MM-DDTHH:mm:ss.sssZ")),a=Number(new v("static").transform(n,"YYYY-MM-DDTHH:mm:ss.sssZ"));return i<a?-1*t:i>a?t:0};static getfechaActual(){return f.default.locale("es"),(0,f.default)().format("YYYY-MM-DD HH:mm:ss")}static getfechaFormatoEnvio(t){return f.default.locale("es"),(0,f.default)(t).format("YYYY-MM-DD HH:mm:ss")}static getfechaActualMas1Year(){return f.default.locale("es"),(0,f.default)().add(1,"year").format("YYYY-MM-DD HH:mm:ss")}static aleatoryName=()=>{let t=window.crypto,e=new Uint32Array(1);return(t.getRandomValues(e)[0]*new Date().getTime()).toString(36).replace(/\./g,"")};static separateArrayInOtherArray(t,e,n=2){t.forEach((i,a)=>{a%n===0?e.push([i]):e[(a-a%n)/n].push(i)})}static empty(t){switch(t){case"":case 0:case"0":case null:case!1:case typeof t>"u":return!0;default:return!1}}static isValidObjectId(t){return!!T.objectIdPattern.test(t)}static convertStringToDate(t){let n=(0,f.default)(t,"DD/MM/yyyy HH:mm:ss");return n.isValid()?n.toDate():null}static convertDateToString(t){debugger;if(!t)return"";let e;return typeof t=="string"?e=oe(t,"dd/MM/yyyy",new Date):e=t,isNaN(e.getTime())?(console.error("Invalid date:",t),""):le(e,"dd/MM/yyyy")}static parseDate(t){if(!t)return null;let[e,n,i]=t.split("/").map(Number);return new Date(i,n-1,e).toISOString().split("T")[0]}};export{se as a,de as b};
