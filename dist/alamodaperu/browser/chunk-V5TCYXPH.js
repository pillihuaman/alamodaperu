import{a as f}from"./chunk-X3J7YRVF.js";import{a as re}from"./chunk-UKJ5OTZR.js";import{a as v}from"./chunk-IVSMQMJ3.js";import"./chunk-GJEU6FZM.js";import{a as ne}from"./chunk-6HQQTRXB.js";import"./chunk-XTPKAL2A.js";import{a as ie}from"./chunk-DONKOUFG.js";import{a as oe}from"./chunk-C4MTUD5M.js";import{a as m}from"./chunk-SM2U5EFL.js";import{Aa as a,Ed as $,Fd as U,G as F,Ga as p,Hd as J,Ib as M,Id as K,J as C,Jb as b,Jd as Q,Kb as P,Kd as X,Lb as q,Ld as Y,Nd as Z,Od as ee,Pa as u,Pb as j,Sb as B,Vb as k,ac as A,cc as O,dc as z,ea as y,fd as w,ia as s,k as _,kd as H,la as N,lb as I,ld as G,m as S,md as L,oa as T,ob as R,p as E,pd as V,qd as W,sa as h,sd as x,te,w as D,za as r}from"./chunk-5E6KOILT.js";var g=class l{constructor(c){this.supportRepository=c}employeesSubject=new _([]);employees$=this.employeesSubject.asObservable();fetchEmployees(c,t,i,e,o,n){this.supportRepository.findEmployee(c,t,i,e,o,n).subscribe(d=>{this.employeesSubject.next(d.payload)})}reloadEmployees(){this.employeesSubject.next(this.employeesSubject.value)}static \u0275fac=function(t){return new(t||l)(C(f))};static \u0275prov=F({token:l,factory:l.\u0275fac,providedIn:"root"})};var ae=class l extends ne{constructor(t,i,e,o,n,d,se){super(e,o,se);this.fb=t;this.supportService=i;this.datePipe=n;this.employeeService=d;this.employeRequest={finishDateFormatted:"",startDateFormatted:""}}employeRequestForm;employeRequest;datas=[];teestMod="tees";isModalVisible=!1;isLoading=!1;isdelelete;searchButtonDisabled=!0;typeOfSearch;listError;columnMappin(){return{id:"ID",name:"Name",lastName:"Last Name",startDate:"Start Date",finishDate:"Finish Date",totalHours:"Total Hours",total:"Total",document:"Document"}}ngOnInit(){this.buildForm(),this.loadEmployees(),this.findEmproyeeProcess()}loadEmployees(){this.employeeService.employees$.subscribe(t=>{this.processEmployeeData(t),this.spinnerService.hide()})}processEmployeeData(t){this.datas=this.customizePropertyNames(t,this.columnMappin()),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1)}findByDefualtg(){let t=this.employeRequestForm.value.idToFind||"",i=this.employeRequestForm.value.nameToFind||"",e=this.employeRequestForm.value.lastNameToFind||"",o=this.employeRequestForm.value.documentToFind||"";this.employeeService.fetchEmployees(this.page??m.page,this.pageSize??m.perPage,t,i,e,o)}deleting(t){this.openDeleteModal(t).componentRef.instance.deleteConfirmed.subscribe(()=>{this.handleDeleteAction(t)})}buildForm(){this.employeRequestForm=this.fb.group({id:[""],name:["",b.required],lastName:[""],startDate:[""],finishDate:[""],document:["",b.required],typeDocument:[""],salaryHours:[""],idToFind:[""],nameToFind:[""],lastNameToFind:[""],documentToFind:[""]})}findEmproyeeProcess(){this.spinnerService.show();let t=this.employeRequestForm.value.idToFind||"",i=this.employeRequestForm.value.nameToFind||"",e=this.employeRequestForm.value.lastNameToFind||"",o=this.employeRequestForm.value.documentToFind||"";this.supportService.findEmployee(this.page,this.pageSize,t,i,e,o).pipe(E(n=>{let d=n?.payload||[];return this.customizePropertyNames(d,this.columnMappin())}),D(n=>(console.error("Error fetching employees:",n),S([])))).subscribe(n=>{this.datas=n,console.log("Data source page",this.datas),this.setDefaultColumns(this.datas),this.datas&&this.datas.length>0?this.updateHasMorePagesT(!0):this.updateHasMorePagesT(!1),this.spinnerService.hide()})}handleDeleteAction(t){if(console.log("Deleting:",t),t.data.ID!==void 0){let i=t.data.ID;this.supportService.deleteEmployee(i).subscribe(e=>{this.showSuccessMessage("Delete Success","Success"),this.isdelelete=t},e=>{(e.status===422||e.status===500)&&e.error&&e.error.data&&e.error.data.payload&&e.error.data.payload.forEach(o=>{let n=o.propertyPath,d=o.valExceptionDescription;this.employeRequestForm.get(n)?.setErrors({invalid:!0,customError:d})}),this.spinnerService.hide()})}}handleEditicionAction(t){if(!t?.data?.ID){console.warn("Invalid employee data.");return}let i=t.data.ID}checkInputs(){let t=this.employeRequestForm.get("idToFind")?.value||"",i=this.employeRequestForm.get("nameToFind")?.value||"",e=this.employeRequestForm.get("lastNameToFind")?.value||"",o=this.employeRequestForm.get("documentToFind")?.value||"";this.searchButtonDisabled=!(t||i||e||o),this.searchButtonDisabled&&(this.page=m.page,this.typeOfSearch=m.typeSearchDefault,this.findEmproyeeProcess())}findByparameter(){this.listError=this.validateObjectID(),this.listError.length===0&&(this.employeRequestForm.get("idToFind")?.markAsTouched(),this.page=m.page,this.pageSize=m.perPage,this.typeOfSearch=m.typeSearchEspecific,this.findEmproyeeProcess())}findByDefualt(){this.findEmproyeeProcess()}validateObjectID(){let t=this.employeRequestForm.get("idToFind")?.value||"",i=[],e=v.isValidObjectId(t);return v.empty(t)||e||i.push("ID is not valid."),i}onNewClick(){}static \u0275fac=function(i){return new(i||l)(s(A),s(f),s(oe),s(ie),s(I),s(g),s(Z))};static \u0275cmp=N({type:l,selectors:[["app-employee"]],features:[T],decls:25,vars:7,consts:[[1,"form-container"],[3,"formGroup"],["multi","true"],["expanded","true"],[1,"form-grid"],["nbInput","","fullWidth","","type","text","placeholder","ID","formControlName","idToFind",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Name","formControlName","nameToFind",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Last Name","formControlName","lastNameToFind",3,"input"],["nbInput","","fullWidth","","type","text","placeholder","Document","formControlName","documentToFind",3,"input"],[1,"button-container"],["nbButton","","status","primary",3,"click","disabled"],["nbButton","","status","success",3,"click"],[3,"pageChange","pageSizeChange","deleteAction","editAction","loadMoreData","noData","datas","defaultColumns","isdelelete","hasMorePages","typeOfSearch"]],template:function(i,e){i&1&&(r(0,"nb-layout")(1,"nb-layout-column")(2,"div",0)(3,"form",1)(4,"nb-accordion",2)(5,"nb-accordion-item",3)(6,"nb-accordion-item-header"),u(7," Search Information "),a(),r(8,"nb-accordion-item-body")(9,"div",4)(10,"input",5),p("input",function(){return e.checkInputs()}),a(),r(11,"input",6),p("input",function(){return e.checkInputs()}),a(),r(12,"input",7),p("input",function(){return e.checkInputs()}),a(),r(13,"input",8),p("input",function(){return e.checkInputs()}),a()(),r(14,"div",9)(15,"button",10),p("click",function(){return e.findByparameter()}),u(16," Search "),a(),r(17,"button",11),p("click",function(){return e.onNewClick()}),u(18," New "),a()()()()(),r(19,"nb-accordion",2)(20,"nb-accordion-item",3)(21,"nb-accordion-item-header"),u(22," Data Information "),a(),r(23,"nb-accordion-item-body")(24,"app-table-datasource",12),p("pageChange",function(n){return e.onPageChange(n)})("pageSizeChange",function(n){return e.onPageSizeChange(n)})("deleteAction",function(n){return e.deleting(n)})("editAction",function(n){return e.handleEditicionAction(n)})("loadMoreData",function(){return e.findEmproyeeProcess()})("noData",function(){return e.showNoDataMessage()}),a()()()()()()()()),i&2&&(y(3),h("formGroup",e.employeRequestForm),y(12),h("disabled",e.searchButtonDisabled),y(9),h("datas",e.datas)("defaultColumns",e.defaultColumnsInput)("isdelelete",e.isdelelete)("hasMorePages",e.hasMorePagesT)("typeOfSearch",e.typeOfSearch))},dependencies:[R,z,j,M,P,q,B,k,L,G,H,U,$,w,O,ee,x,V,W,Y,J,K,X,Q,te,re],styles:[".form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:16px}"]})};export{ae as EmployeeComponent};
